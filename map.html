<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>CCTV SMART VIEW - Map</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<style>
  body, html {
    margin:0; padding:0;
    width:100%; height:100%;
    font-family:"Prompt", sans-serif;
    background:#0d1117;
  }

  #map {
    width:100%;
    height:100dvh;
  }

  /* ========== BOTTOM CONTROL BAR (NEW!) ========== */
  .bottom-controls {
    position:fixed;
    bottom:15px; left:0; right:0;
    display:flex;
    justify-content:center;
    z-index:9999;
    pointer-events:none;
  }

  .bottom-inner {
    display:flex;
    gap:12px;
    background:rgba(255,255,255,0.15);
    backdrop-filter:blur(18px);
    padding:10px 16px;
    border-radius:14px;
    box-shadow:0 6px 24px rgba(0,0,0,0.35);
    pointer-events:auto;
    align-items:center;
    animation:fadeUp .35s ease;
  }

  @keyframes fadeUp {
    from { opacity:0; transform:translateY(10px); }
    to   { opacity:1; transform:translateY(0); }
  }

  .back-btn {
    background:rgba(255,255,255,0.9);
    border:none;
    padding:8px 14px;
    border-radius:10px;
    cursor:pointer;
    font-size:14px;
    font-weight:500;
    color:#333;
    box-shadow:0 3px 10px rgba(0,0,0,0.2);
    transition:.2s;
  }
  .back-btn:hover { transform:translateY(-2px); }

  .status-group {
  display:flex;
  align-items:center;
  gap:14px;
  padding:10px 14px;
  border-radius:12px;
  font-size:14px;
  font-weight:600;
  background:rgba(0,0,0,0.65);
  backdrop-filter:blur(12px);
  border:1px solid rgba(255,255,255,0.08);
  box-shadow:0 6px 22px rgba(0,0,0,0.4);
  color:#fff;
}

.status-chip {
  display:flex;
  align-items:center;
  gap:6px;
  padding:4px 8px;
  border-radius:8px;
  font-size:14px;
  font-weight:600;
  min-width:100px;
  justify-content:center;
}

.status-chip.online {
  background:rgba(46,204,113,0.28);
  color:#2ecc71;
  border:1px solid rgba(46,204,113,0.65);
}

.status-chip.offline {
  background:rgba(231,76,60,0.28);
  color:#e74c3c;
  border:1px solid rgba(231,76,60,0.65);
}

@media(max-width:768px){
  .status-group {
    gap:8px;
    padding:8px 10px;
    font-size:13px;
  }
  .status-chip {
    min-width:80px;
    font-size:12px;
    padding:4px 6px;
  }
}


  .online-label{ color:#2ecc71; }
  .offline-label{ color:#e74c3c; }

  /* ===== POPUP CARD (Modern Glass) ===== */
  .leaflet-popup-content-wrapper {
    border-radius:16px !important;
    overflow:hidden !important;
    padding:0 !important;
    backdrop-filter:blur(10px);
    background:rgba(255,255,255,0.95);
    box-shadow:0 6px 20px rgba(0,0,0,0.35);
  }

  .cam-card {
    width:240px;
    font-size:14px;
  }

  .cam-header {
    background:#f7f9fc;
    padding:10px 14px;
    font-weight:600;
    border-bottom:1px solid #e1e5ea;
  }

  .cam-status {
    padding:8px 14px;
    font-size:13px;
  }
  .cam-status.online { color:#2ecc71; }
  .cam-status.offline { color:#e74c3c; }

  .cam-img {
    width:100%;
    height:160px;
    object-fit:cover;
    cursor:pointer;
    display:block;
    transition:0.25s ease;
  }
  .cam-img:hover { transform:scale(1.02); }

  /* ===== MOBILE OPTIMIZED ===== */
  @media(max-width:768px){
    .cam-card { width:200px; }
    .status-group { font-size:12px; padding:5px 8px; gap:8px; }
    .back-btn { font-size:13px; padding:6px 10px; }
  }

  @media(max-width:480px){
    .cam-card { width:180px; }
  }

</style>
</head>
<body>

<div id="map"></div>

<div class="bottom-controls">
  <div class="bottom-inner">
    <button class="back-btn" onclick="location.href='dashboard.html'">‚Üê Back</button>
    <div class="status-group" id="statusBox">
      <span class="online-label">üü¢ Online: 0</span>
      <span class="offline-label">üî¥ Offline: 0</span>
    </div>
  </div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
  const cameras = [
    { id:1, name:"Stock Area 1", pos:[13.81270,100.69040], online:true,  image:"icons/thief.jpeg" },
    { id:2, name:"Stock Area 2", pos:[13.81210,100.68590], online:true,  image:"icons/thief.jpeg" },
    { id:3, name:"Stock Area 3", pos:[13.81150,100.69200], online:true,  image:"icons/thief.jpeg" },
    { id:4, name:"‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô", pos:[13.81080,100.68480], online:true,  image:"icons/thief.jpeg" },
    { id:5, name:"‡∏ó‡∏≤‡∏á‡πÄ‡∏î‡∏¥‡∏ô‡∏ä‡∏±‡πâ‡∏ô 2", pos:[13.81020,100.69150], online:true,  image:"icons/thief.jpeg" },
    { id:6, name:"‡∏´‡πâ‡∏≠‡∏á CEO", pos:[13.80960,100.68530], online:true,  image:"icons/thief.jpeg" },
    { id:7, name:"Sand Box", pos:[13.80890,100.69080], online:false, image:"icons/thief.jpeg" },
    { id:8, name:"‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£", pos:[13.80830,100.68640], online:false, image:"icons/thief.jpeg" }
  ];

  const map = L.map('map').setView([13.80981,100.68723], 17);

  L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
    attribution:"¬© OpenStreetMap"
  }).addTo(map);

  const iconOnline = L.icon({ iconUrl:"icons/cctv.png", iconSize:[32,32], iconAnchor:[16,32] });
  const iconOffline = L.icon({ iconUrl:"icons/cctv_offline.png", iconSize:[32,32], iconAnchor:[16,32] });

  function openFullscreen(elem){
    if(elem.requestFullscreen) elem.requestFullscreen();
  }

  function renderMarkers(){
    let online = cameras.filter(c=>c.online).length;
    let offline = cameras.filter(c=>!c.online).length;

    document.getElementById("statusBox").innerHTML = `
      <span class="online-label">üü¢ Online: ${online}</span>
      <span class="offline-label">üî¥ Offline: ${offline}</span>
    `;

    cameras.forEach(cam=>{
      const marker = L.marker(cam.pos,{ icon: cam.online?iconOnline:iconOffline });

      const popup = `
        <div class="cam-card">
          <div class="cam-header">${cam.name}</div>
          <div class="cam-status ${cam.online?'online':'offline'}">
            ${cam.online?'üü¢ Online':'üî¥ Offline'}
          </div>
          ${cam.online ? `<img src="${cam.image}" class="cam-img" onclick="openFullscreen(this)">` : ""}
        </div>
      `;

      marker.bindPopup(popup);
      marker.addTo(map);
    });
  }

  renderMarkers();
</script>

</body>
</html>
